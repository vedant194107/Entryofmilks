<!DOCTYPE html>
<html>
  <head>
    <title>Milk Entry Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />

<style>

/* Remove extra outer spacing */
body {
  overflow-x: hidden;
}

/* Tight mobile layout */
@media (max-width: 768px) {

  /* Reduce card padding */
  .card {
    margin-bottom: 12px !important;
  }

  .card-body {
    padding: 8px !important;
  }

  /* Compact table */
  .table {
    min-width: 600px;
    margin-bottom: 0;
  }

  .table th,
  .table td {
    padding: 6px 8px !important;
    font-size: 12px;
    vertical-align: middle;
  }

  .table small {
    font-size: 10px;
  }

  /* Compact buttons */
  .btn-sm {
    font-size: 11px;
    padding: 3px 6px;
  }

  /* Keep buttons inline properly */
  .action-btns {
    display: flex;
    gap: 4px;
    justify-content: center;
  }

}

/* Scroll only once */
.table-responsive {
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
}

</style>




  </head>

  <body class="bg-light">
    <div class="container py-4">
      <h2 class="mb-4 text-center">Milk Entry Dashboard</h2>

      <!-- ADD ENTRY CARD -->
      <div class="card mb-3 shadow-sm">
        <div class="card-body">
          <form method="post">
            {% csrf_token %}

            <div class="row g-3 align-items-end">
              <!-- тЬЕ MILK TYPE (READ ONLY тАУ SELECTED ONE TIME) -->
              <!-- MILK TYPE (SELECT ONCE, EDITABLE LATER) -->
              <div class="col-12 col-md-4">
                <label class="form-label fw-semibold">ркжрлВркзркирлЛ рккрлНрк░ркХрк╛рк░</label>

                <select name="milk_type" id="milkType" class="form-select" onchange="setMilkPrice()">
                  <option value="">Select milk</option>

                  {% if milk and milk.milk_type == 'cow' %}
                    <option value="cow" selected>ЁЯРД ркЧрк╛ркпркирлБркВ ркжрлВркз</option>
                  {% else %}
                    <option value="cow">ЁЯРД ркЧрк╛ркпркирлБркВ ркжрлВркз</option>
                  {% endif %}

                  {% if milk and milk.milk_type == 'buffalo' %}
                    <option value="buffalo" selected>ЁЯРГ ркнрлЗркВрк╕ркирлБркВ ркжрлВркз</option>
                  {% else %}
                    <option value="buffalo">ЁЯРГ ркнрлЗркВрк╕ркирлБркВ ркжрлВркз</option>
                  {% endif %}
                </select>
              </div>

              <!-- LITER -->
              <div class="col-12 col-md-4">
                <label class="form-label fw-semibold">ркХрлЗркЯрк▓рк╛ рк▓рк┐ркЯрк░ ркжрлВркз?</label>
                <select name="liter" class="form-select" required>
                  <option value="4">4 рк▓рк┐ркЯрк░</option>
                  <option value="5">5 рк▓рк┐ркЯрк░</option>
                  <option value="6">6 рк▓рк┐ркЯрк░</option>
                  <option value="8">8 рк▓рк┐ркЯрк░</option>
                  <option value="10">10 рк▓рк┐ркЯрк░</option>
                  <option value="12">12 рк▓рк┐ркЯрк░</option>
                </select>
              </div>

              <!-- BUTTON -->
              <div class="col-12 col-md-4 d-grid">
                <button class="btn btn-success w-100">тЮХ Add Entry</button>
              </div>
            </div>
          </form>
        </div>
      </div>

      <!-- PRICE CARD -->
      <div class="card mb-4 shadow-sm">
        <div class="card-body">
          <form method="post" class="row g-3 align-items-end">
            {% csrf_token %}
            <div class="col-md-6">
              <label class="form-label">рк▓рк┐ркЯрк░ ркжрлАрка ркХрк┐ркВркоркд</label>
              {% comment %} value="{{ price.price_per_liter|default:'' }}" {% endcomment %}
              <input type="number" step="0.01" name="price_per_liter" id="priceInput"  class="form-control" required />
            </div>
            <div class="col-md-3">
              <button class="btn btn-primary w-100" style="height:42px;">Save Price</button>
            </div>
          </form>
        </div>
      </div>

      <!-- FILTER -->
      <div class="card mb-4 shadow-sm">
        <div class="card-body">
          <form method="get" class="row g-3 align-items-end">
            <div class="col-md-4">
              <label class="form-label">Filter by Date</label>
              <input type="date" name="date" value="{{ selected_date }}" class="form-control" />
            </div>
            <div class="col-md-2">
              <button class="btn btn-outline-secondary w-100" style="height:42px;">Filter</button>
            </div>
            <div class="col-md-2">
              <a href="/" class="btn btn-outline-dark w-100" style="height:42px; line-height:28px;">Reset</a>
            </div>
          </form>
        </div>
      </div>

      <!-- SUMMARY -->
      <div class="row mb-4">
        <div class="col-md-6">
          <div class="card text-center shadow-sm">
            <div class="card-body">
              <h6 class="text-muted">ркХрлБрк▓ рк▓рк┐ркЯрк░</h6>
              <h2 class="text-primary">{{ total_liter }} L</h2>
            </div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="card text-center shadow-sm">
            <div class="card-body">
              <h6 class="text-muted">ркХрлБрк▓ рк░ркХрко</h6>
              <h2 class="text-success">тВ╣ {{ total_amount }}</h2>
            </div>
          </div>
        </div>
      </div>

      <!-- DOWNLOAD BUTTONS -->
      {% if entries %}
        <div class="d-flex gap-2 mb-4">
          <a href="/monthly-excel/?month={{ entries.0.date|date:'Y-m' }}" class="btn btn-outline-success">тмЗ Download Monthly Excel</a>
          <a href="/download-pdf/" class="btn btn-outline-success">тмЗ Download PDF</a>
        </div>
      {% endif %}

      <!-- TABLE -->
      <div class="card shadow-sm">
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-striped table-bordered align-middle">
              <thead class="table-dark">
                <tr>
                  <th>Date</th>
                  <th>Milk</th>
                  <th>Liter</th>
                  <th>Price / L</th>
                  <th>Amount</th>
                  <th class="text-center">Action</th>
                </tr>
              </thead>
              <tbody>
                {% for e in entries %}
                  <tr>
                    <td data-label="Date">
                      {{ e.created_at|date:'d M Y' }}<br>
                      <small class="text-muted">{{ e.created_at|date:'h:i A' }}</small>
                    </td>
                  
                    <td data-label="Milk">
                      {% if e.milk_type == 'cow' %}
                        ЁЯРД ркЧрк╛ркпркирлБркВ ркжрлВркз
                      {% else %}
                        ЁЯРГ ркнрлЗркВрк╕ркирлБркВ ркжрлВркз
                      {% endif %}
                    </td>
                  
                    <td data-label="Liter">
                      {{ e.liter }} рк▓рк┐ркЯрк░
                    </td>
                  
                    <td data-label="Price / L">
                      тВ╣ {{ e.price_per_liter }}
                    </td>
                  
                    <td data-label="Amount">
                      тВ╣ {{ e.amount }}
                    </td>
                  
                    <td data-label="Action">
                      <div class="action-btns">
                        <a href="/edit/{{ e.id }}/" class="btn btn-sm btn-warning">Edit</a>
                        <form action="/delete/{{ e.id }}/" method="post"
                              style="display:inline;">
                          {% csrf_token %}
                          <button type="submit" class="btn btn-sm btn-danger">
                            Delete
                          </button>
                        </form>

                      </div>
                    </td>
                  </tr>
                {% empty %}
                  <tr>
                    <td colspan="6" class="text-center text-muted py-4">No entries found</td>
                  </tr>
                {% endfor %}
              </tbody>

            </table>
          </div>
        </div>
      </div>
    </div>

    <script>
  function setMilkPrice() {
    const milkType = document.getElementById("milkType").value;
    const priceInput = document.getElementById("priceInput");

    if (milkType === "cow") {
      priceInput.value = 42;
    }
    else if (milkType === "buffalo") {
      priceInput.value = 80;
    }
  }

  // Auto-set price on page load
  window.onload = function () {
    setMilkPrice();
  };
</script>

  </body>
</html>
